https://vananhtooo.wordpress.com/2018/09/06/javascript-executor-trong-selenium-webdriver/

JavaScript Executor trong Selenium Webdriver
SEPTEMBER 6, 2018 VANANHTOLEAVE A COMMENT
HÃ´m nay sáº½ cÃ¹ng cÃ¡c báº¡n tÃ³m lÆ°á»£c vá» thÃ nh pháº§n khÃ¡ lÃ  máº¡nh máº½ trong Selenium Webdriver nhÆ° tiÃªu Ä‘á» bÃ i viáº¿t. Hi vá»ng ráº±ng bÃ i viáº¿t sáº½ giÃºp cÃ¡c báº¡n biáº¿t hÆ¡n vá» Javascript Executor cÃ²n cÃ³ hiá»ƒu hÆ¡n khÃ´ng thÃ¬ chÆ°a biáº¿t. :v

1. Tá»•ng quan vá» Javascript Executor
Javascript Executor lÃ  má»™t interface cá»§a Selenium Webdriver, nÃ³ cÃ³ chá»©c nÄƒng tÆ°Æ¡ng tá»± nhÆ° cá»§a Java Script vÃ  cÃ³ thá»ƒ tÆ°Æ¡ng tÃ¡c vá»›i cÃ¡c pháº§n tá»­ HTML DOM. Thay vÃ¬ sá»­ dá»¥ng method driver.findElement cá»§a Selenium Webdriver thÃ¬ chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng JavaScriptExecutor Interface Ä‘á»ƒ thá»±c hiá»‡n nhá»¯ng thao tÃ¡c tÆ°Æ¡ng tá»± trÃªn trang á»©ng dá»¥ng.


Javascript Executor cho phÃ©p chÃºng ta cÃ³ thá»ƒ cháº¡y mÃ£ Javascript thuáº§n tÃºy báº¥t ká»ƒ lÃ  chÃºng ta Ä‘ang sá»­ dá»¥ng ngÃ´n ngá»¯ nÃ o vá»›i Selenium nhÆ° Java, C# hay Pythonâ€¦

ThÆ°á»ng thÃ¬ chÃºng ta sáº½ chá»‰ sá»­ dá»¥ng Javascript Executor trong nhá»¯ng trÆ°á»ng há»£p mÃ  khi sá»­ dá»¥ng cÃ¡c method thÃ´ng thÆ°á»ng khÃ¡c vá»›i Selenium nÃ³ khÃ´ng thá»ƒ thá»±c thi Ä‘Æ°á»£c nhÆ° mong muá»‘n.

Äá»ƒ sá»­ dá»¥ng Ä‘Æ°á»£c Javascript Executor, khÃ´ng nháº¥t thiáº¿t báº¡n pháº£i cÃ³ kiáº¿n thá»©c vÃ  hiá»ƒu biáº¿t quÃ¡ sÃ¢u vá» Javascript má»›i lÃ m Ä‘Æ°á»£c, má»™t thá»±c táº¿ lÃ  báº¡n chá»‰ cáº§n tÃ¬m kiáº¿m Google lÃ  ra cáº£ tÃ¡ :v tá»« Stackoverflow cho Ä‘áº¿n Guru99 hay ToolSQA â€¦ sau Ä‘Ã³ copy vá» dÃ¹ng thÃ´i. NhÆ°ng sáº½ tá»‘t hÆ¡n náº¿u báº¡n hiá»ƒu vá» nÃ³, Ä‘á»ƒ cÃ³ thá»ƒ linh hoáº¡t sá»­ dá»¥ng trong nhiá»u nhá»¯ng trÆ°á»ng há»£p cÃ³ thá»ƒ gáº·p sau nÃ y! ğŸ˜€

NhÆ° Ä‘Ã£ nÃ³i phÃ­a trÃªn, Javascript lÃ  má»™t interface thuá»™c package org.openqa.selenium trongSelenium Webdriver. CÃ³ hai abstract method lÃ :

executeScript()
executeAsyncScript()
Äá»ƒ sá»­ dá»¥ng cÃ¡c method trong Javascript Executor interface ta pháº£i Ã©p Ä‘á»‘i tÆ°á»£ng driver thÃ nh kiá»ƒu Javascript Executor, theo cÃº phÃ¡p dÆ°á»›i Ä‘Ã¢y:

// chuyá»ƒn kiá»ƒu cá»§a Ä‘á»‘i tÆ°á»£ng driver thÃ nh JavascriptExecutor
JavascriptExecutor js = (JavascriptExecutor) driver;

// sá»­ dá»¥ng cÃ¡c methods
js.executeScript("javascript command");
js.executeAsyncScript("javascript command");
Háº§u nhÆ° lÃ  chÃºng ta sáº½ sá»­ dá»¥ng method executeScript() cÃ²n vá» executeAsyncScript() mÃ¬nh cÅ©ng chÆ°a dÃ¹ng vÃ  chÆ°a tÃ¬m hiá»ƒu nÃªn sáº½ khÃ´ng nháº¯c Ä‘áº¿n á»Ÿ Ä‘Ã¢y â€“ nÃªn cÅ©ng Ä‘á»«ng tháº¯c máº¯c mÃ¬nh nha. :v

BÃªn cáº¡nh cÃº phÃ¡p trÃªn, cÅ©ng cÃ³ má»™t cÃ¡ch khÃ¡c ngáº¯n hÆ¡n Ä‘á»ƒ sá»­ dá»¥ng Javascript Executor, nhÆ°ng theo khuyáº¿n cÃ¡o Ä‘Ã¢y khÃ´ng pháº£i lÃ  cÃ¡ch hoÃ n háº£o nháº¥t, tuy nhiÃªn khi tÃ¬m kiáº¿m tá»« Google láº¡i ra ráº¥t nhiá»u káº¿t quáº£ hÆ°á»›ng dáº«n giá»‘ng nhÆ° nÃ y vÃ  mÃ¬nh cÅ©ng chÆ°a hiá»ƒu táº¡i sao mÃ  nÃ³ láº¡i khÃ´ng pháº£i lÃ  má»™t cÃ¡ch hoÃ n háº£o nháº¥t nhÆ° lá»i khuyáº¿n cÃ¡o ğŸ˜ :

((JavascriptExecutor) driver).executeScript("javascript command");
2. Sá»­ dá»¥ng Javascript Executor
2.1. TÃ¬m 1 pháº§n tá»­ vá»›i Javascript Executor (Find an element)
á» vÃ­ dá»¥ phÃ­a dÆ°á»›i, mÃ¬nh sá»­ dá»¥ng ID Ä‘á»ƒ tÃ¬m má»™t pháº§n tá»­ trÃªn má»™t trang, chÃºng ta cÅ©ng cÃ³ thá»ƒ thay báº±ng cÃ¡c thuá»™c tÃ­nh khÃ¡c tÆ°Æ¡ng á»©ng cá»§a pháº§n tá»­ cáº§n tÃ¬m nhÆ° Name, hay CSS.

CÃº phÃ¡p:

JavascriptExecutor js = (JavascriptExecutor) driver;
Object searchTextbar = js.executeScript
                       ("return document.getElementById('lst-ib')");
((WebElement) searchTextbar).sendKeys("abc");
2.2. Click vÃ o má»™t pháº§n tá»­ nÃ o Ä‘Ã³ (Click an element)
TÆ°Æ¡ng tá»± nhÆ° khi tÃ¬m kiáº¿m má»™t pháº§n tá»­, vá»›i Javascript Executor ta cÅ©ng cÃ³ thá»ƒ thá»±c hiá»‡n thao tÃ¡c click vÃ o má»™t pháº§n tá»­ dá»±a trÃªn thÃ´ng tin cá»§a pháº§n tá»­ Ä‘Ã³. á» vÃ­ dá»¥ phÃ­a dÆ°á»›i Ä‘Ã¢y mÃ¬nh thá»±c hiá»‡n láº¥y pháº§n tá»­ dá»±a theo tÃªn cá»§a nÃ³, ta cÃ³ cÃº phÃ¡p nhÆ° sau:

JavascriptExecutor js = (JavascriptExecutor) driver;
js.executeScript("document.getElementsByName('btnI')[0].click()");
2.3. Thá»±c hiá»‡n sendKey
Ta cÃ³ thá»ƒ sá»­ dá»¥ng Javascript Executor Ä‘á»ƒ thá»±c hiá»‡n truyá»n giÃ¡ trá»‹ cho cÃ¡c pháº§n tá»­ cho phÃ©p nháº­p dá»¯ liá»‡u lÃ  textbox hay text area trong Selenium Webdriver. CÃ¡c báº¡n cÃ³ thá»ƒ tham kháº£o cÃº phÃ¡p dÆ°á»›i Ä‘Ã¢y:

JavascriptExecutor js = (JavascriptExecutor) driver;
js.executeScript("document.getElementById('lst-ib').value='chercher tech'");
2.4. Thá»±c hiá»‡n scroll webpage (cuá»™n trang)
TrÆ°á»ng há»£p nÃ y cÃ³ láº½ lÃ  quen thuá»™c hÆ¡n cáº£, Ä‘Ã³ lÃ  khi mÃ  trang á»©ng dá»¥ng quÃ¡ dÃ i, vÃ  khÃ´ng thá»ƒ hiá»ƒn thá»‹ háº¿t chiá»u dÃ i ná»™i dung trong khung mÃ n hÃ¬nh Ä‘Æ°á»£c, do váº­y mÃ  ta sáº½ cáº§n pháº£i thá»±c hiá»‡n cuá»™n trang Ä‘á»ƒ cÃ³ thá»ƒ di chuyá»ƒn Ä‘áº¿n vá»‹ trÃ­ tá»a Ä‘á»™ cá»¥ thá»ƒ mong muá»‘n trÃªn trang á»©ng dá»¥ng. ÄÃ¢y lÃ  cÃ´ng viá»‡c mÃ  ta sáº½ khÃ´ng thá»ƒ dÃ¹ng Selenium webdriver Ä‘á»ƒ thá»±c hiá»‡n Ä‘Æ°á»£c. LÃºc nÃ y, Javascript Executor sáº½ giÃºp báº¡n lÃ m viá»‡c nÃ y má»™t cÃ¡ch dá»… dÃ ng, vá»›i cÃº phÃ¡p:

JavascriptExecutor js = (JavascriptExecutor)driver;
js.executeScript("window.scrollBy(0,300)");
Giáº£i thÃ­ch má»™t chÃºt chá»— js.executeScript(â€œwindow.scrollBy(0,300)â€);

scrollBy(horizontalDistance,verticalDistance): ta cÃ³ hai tham sá»‘ Ä‘áº§u vÃ o lÃ :

horizontalDistance â€“ LÃ  khoáº£ng cÃ¡ch Ä‘Æ°á»£c cuá»™n theo chiá»u ngang
verticalDistance â€“ Khoáº£ng cÃ¡ch Ä‘Æ°á»£c cuá»™n theo chiá»u dá»c
NhÆ° vÃ­ dá»¥ phÃ­a trÃªn mÃ¬nh cÃ³ scrollBy(0, 300) cÃ³ nghÄ©a lÃ  cuá»™n xuá»‘ng phÃ­a dÆ°á»›i 300px theo chiá»u dÃ i cá»§a trang web. TÆ°Æ¡ng tá»± báº¡n cÃ³ thá»ƒ thay báº±ng cÃ¡c giÃ¡ trá»‹ khÃ¡c tÃ¹y theo yÃªu cáº§u vÃ  mong muá»‘n.

2.5. Scroll into view
Vá»‘n tá»« mÃ¬nh hÆ¡i Ã­t nÃªn khÃ´ng biáº¿t dÃ¹ng tá»« diá»…n Ä‘áº¡t sang Tiáº¿ng Viá»‡t nhÆ° nÃ o cho dá»… hiá»ƒu, á»Ÿ Ä‘Ã¢y cÃ³ thá»ƒ hiá»ƒu nÃ´m na ráº±ng lÃ  cuá»™n trang Ä‘áº¿n má»™t vÃ¹ng cá»¥ thá»ƒ hoáº·c má»™t pháº§n tá»­ cá»¥ thá»ƒ nÃ o Ä‘Ã³ trÃªn trang. VÃ­ dá»¥: ta cÃ³ thá»ƒ gáº·p trÆ°á»ng há»£p nhÆ° muá»‘n tÆ°Æ¡ng tÃ¡c Ä‘áº¿n má»™t trÆ°á»ng A nÃ o Ä‘Ã³ trÃªn trang á»©ng dá»¥ng, nhÆ°ng vÃ¬ cÃ³ nhiá»u thÃ´ng tin nÃªn trÆ°á»ng nÃ y khÃ´ng thá»ƒ hiá»ƒn thá»‹ Ä‘Æ°á»£c trÃªn má»™t mÃ n hÃ¬nh mÃ  pháº£i cuá»™n  trang web xuá»‘ng phÃ­a dÆ°á»›i trÆ°á»ng nÃ y Ä‘á»ƒ nháº­p thÃ´ng tin, lÃºc nÃ y sá»­ dá»¥ng â€œscroll into viewâ€ Ä‘á»ƒ cuá»™n xuá»‘ng phÃ­a dÆ°á»›i, ta sáº½ nhÃ¬n tháº¥y trÆ°á»ng nÃ y á»Ÿ trÃªn mÃ n hÃ¬nh hiá»ƒn thá»‹, vÃ  cho Ä‘áº¿n thá»i Ä‘iá»ƒm nÃ y báº¡n má»›i thá»±c hiá»‡n tÆ°Æ¡ng tÃ¡c Ä‘Æ°á»£c vá»›i trÆ°á»ng A thÃ´ng qua Selenium.

KhÃ´ng biáº¿t vá»›i vÃ­ dá»¥ trÃªn cÃ¡c báº¡n Ä‘Ã£ hÃ¬nh dung Ä‘Æ°á»£c chÆ°a, nhÆ°ng tÃ³m vÃ¡y láº¡i lÃ  Javascript Executor cÃ³ thá»ƒ giÃºp báº¡n lÃ m cÃ¡i cÃ´ng viá»‡c mÃ´ táº£ loáº±ng ngoáº±ng phÃ­a trÃªn kia.

Ta sá»­ dá»¥ng hÃ m scrollIntoView() â€“ tÃªn gá»i Ä‘Ãºng nhÆ° má»¥c Ä‘Ã­ch sá»­ dá»¥ng, vÃ  cÃ³ cÃº phÃ¡p nhÆ° sau:

JavascriptExecutor js = (JavascriptExecutor) driver;
js.executeScript("document.getElementById('default').scrollIntoView(true)");
2.6. Má»™t sá»‘ viá»‡c khÃ¡c mÃ  Javascript Executor cÃ³ thá»ƒ lÃ m Ä‘Æ°á»£c
BÃªn cáº¡nh nhá»¯ng cÃ´ng viá»‡c bÃªn trÃªn Javascript Executor cÃ³ thá»ƒ xá»­ lÃ½ ngon lÃ nh thÃ¬ cÅ©ng cÃ²n cÃ³ ráº¥t nhiá»u nhá»¯ng tÃ¡c vá»¥ khÃ¡c mÃ  ta cÃ³ thá»ƒ â€œlá»£i dá»¥ngâ€ Javascript Executor lÃ m náº¿u tháº¥y â€œthÃ­châ€ nhÆ°:

1. Láº¥y ra thÃ´ng tin title cá»§a á»©ng dá»¥ng web vá»›i cÃº phÃ¡p:
js.executeScript("return document.title");
2. Láº¥y ra thÃ´ng tin Ä‘á»‹a chá»‰ URL cá»§a á»©ng dá»¥ng:
js.executeScript("return document.URL");
3. Kiá»ƒm tra tráº¡ng thÃ¡i cá»§a trang web Ä‘Ã£ Ä‘Æ°á»£c táº£i vá» hay chÆ°a:
js.executeScript("return document.readyState");
4. Äiá»u chá»‰nh má»©c Ä‘á»™ phÃ³ng to thu nhá» hiá»ƒn thá»‹ cá»§a ná»™i dung trang web:
js.executeScript("document.body.style.zoom='90");
5. Láº¥y ra thÃ´ng tin vá» kÃ­ch thÆ°á»›c cá»§a á»©ng dá»¥ng web:
// Äá»™ cao
js.executeScript("window.innerHeight");
// Äá»™ rá»™ng
js.executeScript("window.innerWidth");
6. Láº¥y ra thÃ´ng tin vá» kÃ­ch thÆ°á»›c cá»§a trÃ¬nh duyá»‡t:
js.executeScript("window.outerHeight");
js.executeScript("window.outerWidth");
7. Äiá»u hÆ°á»›ng Ä‘áº¿n má»™t Ä‘á»‹a chá»‰ URL nÃ o Ä‘Ã³:
js.executeScript("window.location="https://google.com";");
VÃ  cÃ²n kha khÃ¡ nhá»¯ng thá»© hay ho khÃ¡c ná»¯a. Tuy nhiÃªn cháº¯c cháº³ng máº¥y khi dÃ¹ng Ä‘áº¿n Ä‘Ã¢u áº¥y, liá»‡t kÃª ra cho má»i ngÆ°á»i biáº¿t Ä‘Æ°á»£c lÃ  Javascript Executor Ä‘Ã­ch thá»‹ lÃ  má»™t â€œsoÃ¡i caâ€ hay ho vÃ  Ä‘a nÄƒng :v. CÃ³ cÃ¡i gÃ¬ mÃ  anh khÃ´ng lÃ m Ä‘Æ°á»£c Ä‘Ã¢u? Chá»‰ lÃ  cÃ¡c em khÃ´ng biáº¿t táº­n dá»¥ng anh thÃ´i =))

NhÆ°ng mÃ  cÃ³ pháº£i Javascript Executor thá»±c sá»± khÃ´ng cÃ³ nhÆ°á»£c Ä‘iá»ƒm gÃ¬? Äá»c tiáº¿p Ä‘á»ƒ xem â€œsoÃ¡i caâ€ nÃ y cuá»‘i cÃ¹ng cÃ³ pháº£i lÃ  â€œMr. Rightâ€ vá»›i Selenium Webdriver khÃ´ng nhÃ©!

3. Javascript Executor cÃ³ pháº£i lÃ  â€œsoÃ¡i caâ€ Ä‘Ã­ch thá»±c?
Äáº§u tiÃªn pháº£i nháº¯c láº¡i má»™t láº§n ráº±ng, Selenium Webdriver hoáº¡t Ä‘á»™ng tÆ°Æ¡ng tá»± nhÆ° má»™t ngÆ°á»i dÃ¹ng cá»¥ thá»ƒ cá»§a á»©ng dá»¥ng. Selenium Webdriver thá»±c thi nhá»¯ng thao tÃ¡c mÃ  má»™t ngÆ°á»i dÃ¹ng thá»±c sá»± cÃ³ thá»ƒ lÃ m Ä‘á»‘i vá»›i má»™t pháº§n tá»­ nÃ o Ä‘Ã³ trÃªn á»©ng dá»¥ng web.

Náº¿u nhÆ° trÃªn thá»±c táº¿, Selenium Webdriver khÃ´ng thá»ƒ tÆ°Æ¡ng tÃ¡c vá»›i má»™t pháº§n tá»­ nÃ o Ä‘Ã³ trÃªn trang á»©ng dá»¥ng thÃ¬ ta cÅ©ng cáº§n pháº£i cÃ¢n nháº¯c xem liá»‡u ráº±ng Ä‘Ã³ cÃ³ pháº£i lÃ  má»™t lá»—i hay khÃ´ng trÆ°á»›c khi sá»­ dá»¥ng Javascript Executor Ä‘á»ƒ Ã©p buá»™c nÃ³ pháº£i cháº¡y theo Ã½ mÃ¬nh. Biáº¿t Ä‘Ã¢u lá»—i tháº­t thÃ¬ cÃ³ pháº£i lÃ  nguy hiá»ƒm khÃ´ng? :v

Báº¡n nÃªn kiá»ƒm tra ká»¹ trÃªn táº¥t cáº£ cÃ¡c trÃ¬nh duyá»‡t vá»›i code Selenium Webdriver thÃ´ng thÆ°á»ng (cÃ¡c trÃ¬nh duyá»‡t mÃ  á»©ng dá»¥ng Ä‘Æ°á»£c yÃªu cáº§u cáº§n pháº£i Ä‘Æ°á»£c test), cÃ³ thá»ƒ pháº§n tá»­ Ä‘Ã³ chá»‰ cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng Ä‘Ãºng trÃªn má»™t trÃ¬nh duyá»‡t nÃ o Ä‘Ã³ â€“ thÃ¬ cÃ³ thá»ƒ cÃ¢n nháº¯c sá»­ dá»¥ng Javascript Executor, cÃ²n náº¿u nhÆ° trÃªn táº¥t cáº£ trÃ¬nh duyá»‡t báº¡n kiá»ƒm tra, pháº§n tá»­ Ä‘Ã³ khÃ´ng hoáº¡t Ä‘á»™ng Ä‘Ãºng thÃ¬ cáº§n Ä‘Ã¡nh False testcase thay vÃ¬ sá»­ dá»¥ng Javascript Executor.

Äiá»u nÃ y sáº½ Ä‘áº£m báº£o ráº±ng báº¡n khÃ´ng bá»‹ lá»t bug, trong trÆ°á»ng há»£p sá»­ dá»¥ng Javascript Executor thÃ¬ cÃ³ thá»ƒ cháº¡y ngon lÃ nh nhÆ°ng trÃªn thá»±c táº¿ thÃ¬ pháº§n tá»­ Ä‘Ã³ láº¡i khÃ´ng hiá»ƒn thá»‹, (do má»™t vÃ i lá»—i trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn) vÃ  Ä‘á»‘i vá»›i ngÆ°á»i dÃ¹ng thá»±c táº¿ báº±ng xÆ°Æ¡ng báº±ng thá»‹t láº¡i cháº³ng thá»ƒ thao tÃ¡c Ä‘Æ°á»£c.

[[ Táº¥t nhiÃªn sáº½ khÃ´ng tÃ­nh nhá»¯ng trÆ°á»ng há»£p Ä‘áº·c biá»‡t khÃ¡c â€“ mÃ  báº¯t buá»™c pháº£i sá»­ dá»¥ng Javascript Executor má»›i lÃ m Ä‘Æ°á»£c. ]]

Tháº¿ nÃªn Ä‘Ã£ tráº£ lá»i cho cÃ¡c báº¡n ráº±ng, Ä‘Ã¢y cÅ©ng cÃ³ thá»ƒ lÃ  má»™t â€œsÃ³i caâ€ vÃ  cÃ¡c báº¡n cáº§n háº¿t sá»©c cáº©n trá»ng nhÃ©! ğŸ˜€

Hi vá»ng ráº±ng bÃ i viáº¿t sáº½ giÃºp cÃ¡c báº¡n cÃ³ thÃªm thÃ´ng tin há»¯u Ã­ch vá» Javasript Executor trong Selenium Webdriver.

CÃ¡c báº¡n cÅ©ng cÃ³ thá»ƒ tham kháº£o thÃªm táº¡i link:

https://chercher.tech/java/javascript-executor-selenium-webdriver#sendkeys